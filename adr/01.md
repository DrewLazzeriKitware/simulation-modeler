# ADR 01: Web interface to solver keys
We want a high-level interface to parflow the way hydrologists think, as opposed to the low-level key inputs for simulation writers. 

Our interface will have some assumptions baked in, some shortcuts the user can choose, and then interfaces to solver keys. For each of the following sections, there is a section in draft.py organizing the relevant keys.

# Baked in

 We assume that the user is only using water. Anecdotally, Reed said other phases were rare. Also, the docs for Solver say that both Richards and Impes assume they are not multi-phase.

We assume that they have an indicator file (.pfb) which we can derive geometry from. It will be a child of indi_input.
> Can a solidfile (.pfsol) be the indicator? 
- It seems a pfsol file describes patches but not indications (subsections). 

> Will we show the options for a homogenous subsurface? Or is that opposed to indicator input?
- We will allow some of the DomainBuilder's homogenous subsurface options to be set for the whole domain, but weassume that others will be attached to the required indicator file. 

We assume that we can derive a box domain which is based on the required indicator file. According to the keys, Domain.GeomName is mandatory and must have patches that equal the entire domain surface.
> Can the indicator be the domain? 
- It seems an indicator file does not describe patches, which the domain must, so we'll use a box.
> Can a solidfile be the domain?
- Yes, and sandtank does this. I don't know a way to render pfsol files in paraview though. I'm assuming this is hard, until I get an answer about  about rendering pfsol. 

# Shortcuts
What does our hydrologist want? To simulate wells? To simulate climates? 

## No Wells 
This just sets empty. 

## No Contaminants 
This just sets empty

## VariablySaturated | FullySaturated
This sets the Solver and a few related parameters. In the little washita example though, the values are adjusted after picking the variably saturated option. 

# Interface

## File Database Page
It is a requirement that there is an indicator file. We won't export the data without one. 

## Domain Page
We assume most geometry can be inferred from the indicator file.
It's possible that the d{xyz} can't be, but documentations suggests it should. I also have a reasonable guess if we can't get anything from the file.
We want have the domain here, since it can validate with the other spacial pfbs. They all must match the required indicator file. 

We assume Initial Conditions are const or a pfb file.

We assume boundary condition sides and bottom of domain are zero flux, and set a cycle and interval which will keep them constant throughout. 

We assume boundary conditions on top is either a OverlandFlow or const

## Subsurface Page
Properties like SpecificStorage might be different per section: Constant, Turnbands, ParGauss etc.
We'll need a form for each of the soil indications which captures the different options. 
We might have a summary like the tables, since that view is useful (especially for consts).

## CLM Page
This resembles the Solver page, but it's only for the subtree of Solver.CLM

## Boundary Conditions page


## Solver Page


# Questions
How many keys am I covering? How many keys will I have covered? Which keys should I cover next? Are there more scripts like Little Washita?

## Validate with a hydrologist
When might you want boundary conditions that are not zero flux? 
When might you want hydroStaticPatches or hydroStaticDeptch in your initial conditions? What about an NC file?
What is the simplest CLM setup you might use?

## Answered
> What does a researcher want out of this? A python file that will run through pftools? On what setup? 
- I assume there is a zip folder structure that makes sense at the end to export. It will have the file database and a python script describing the run (so, dist files etc.). I'll have a docker image with a --data that expects exactly this format and runs the simulation, outputting in the same directory. And if people need, we can put all these apps in the same launcher (conceptual-modeler, simulation-modeler, post-processing). 

> How does one make a pfb file? (Is it hard, so people prefer to make one then assign indices/indications?)
- It's strange

> Do I draw every component?
- Yes. Don't leave anything for when you're coding.

> Do I list every "validity" condition?
- Yes. If they're too much for you on paper, wouldn't they be too much for the researcher?

> What validation info do I have?
- MandatoryValue keys are one source. My own requirements ("Have an indicator") is another. We can add more to the keys, if we know more and want to.

> Can paraview render a pfsol file?
- I'm assuming there's no reader, or it would have been in the parflow plugin. 

> Should  I hide pages? Or grey them?  Should two controls ungrey CLM eg?
- Let's grey pages, and let two controls ungrey CLM if they are in good places. 